# Приветственный бот
Прост как 3 рубля, никаких дополнительных библиотек не требуется.
Отправляет приветствие при добавлении новых пользователей в группу. Все)

Работает на Python 3.8 как функция [lambda на AWS](https://aws.amazon.com/ru/lambda/).

## Для успешного запуска нужно:
1. Создать бота через BotFather, получить токен. Установить настройку /setprivacy - disable
2. Создать файл tg_token.py и завести в нем переменную TG_TOKEN = "token", назначив ей полученный токен.
Положить файл рядом с остальными скриптами.
3. Завести аккаунт на AWS, завести lambda функцию с использованием Python 3.8 с нуля. Залить туда **zip**-архив с кодом
4. Завести API на AWS и назначить его для нашей lambda-функции.
5. Выбрать template для запросов в API для корректной обработки json.
6. Настроить setWebhook - push: по мере поступления новых сообщений сервер Telegram отправляет их вашему боту на API от AWS.
7. Добавить бота в группу. Добавить в папку templates html-файл по аналогии с hello_text.html с названием hello_text_{chat_id}.html, где chat_id - id группы (отрицательное число).


## Нерешенные нюансы:
1. Почему-то lambda сама форматирует event (из json он преобразуется в dict, значение false, например, автоматически заменяется на False).
Удобно, но непонятно почему так происходит и что от этого ждать.
2. Очень скудный туториал по установке. Если будет востребован, могу расписать подробнее.
3. Самое странное, максимальное количество приветственных сообщений за раз - 3 штуки. После 3 запросов падает с таймаутом, при этом при 1 запросе скорость выполнения 123ms. Исключила проблему с логикой работы формирования сообщений.
Если просто стучать по готовым url, все равно та же проблема.


## Про сам код
- Не идеален, но прост.
- Отправку сообщений можно доработать на другие сценарии.
- Класс **Message** можно развить на остальные доступные поля в API.
- Функция **get_name** позволяет получить ссылку на пользователя и позвать его.
- В шаблоне **hello_text.html** есть плейсхолдеры **{name}** - имя пользователя и **{group_name}** - имя чата. Если чат приватный, у него не будет {group_name}. Два шаблона с id группы добавлены для примера.
- Текст приветствия обрабатывается через функцию **get_hello_text**.

